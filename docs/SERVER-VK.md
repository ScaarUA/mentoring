# JSMP3.6: JavaScript on Backend (Kotliar Vitalii)

## Добавление сущностей(State, Flow) и реализация CRUD операций.
Для реализации использовалась классическая REST архитектура. В результате были добавлены следующие маршруты:

````````````
GET /api/flows, GET /api/states - получение массива всех объектов
POST /api/flows, POST /api/states - создание нового объекта
GET/api/flows/:id, GET /api/states:id - получение объекта по id
PUT /api/flows/:id, PUT /api/states/:id - редактирование объекта по id
DELETE /api/flows/:id, DELETE /api/states/:id - удаление объекта по id

```````````
## Работа с файлами.
Сущность State предусматривает хранение файлов. Хранение файлов может осуществляться на сервере в папке /uploads или же в облачном хранилище cloudinary. Для того что бы изменить вариант хранения файлов нужно изменить значение переменой cloudStorage в файле .env. Если переменная имеет значение true, то все файлы будут сохраняться на облачном хранилище, иначе в папке на сервере. Для обработки multipart форм, использовался npm пакет - multer.

## Главный контроллер.
Для обработки некоторых маршрутов можно использовать те же методы, изменяя при этом лишь модель moongoose. С этой целью был разработан класс base.controller в которого имеются все стандартные методы(getOne, getAll, update, remove, create) для обработки маршрутов. Контроллеры flows и state наследуют base.controller за счет чего удалось избежать дублирования кода.

## Обработка ошибок
Обработка ошибок осуществляется через middleware express. Для этого был добавлен errorsHandler.js в который попадают все ошибки, включая 404, используя такой метод мы может обрабатывать и логирывать все ошибки в одном месте.